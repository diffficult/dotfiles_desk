# ============================================================================
# BROWSER WINDOW RULES
# ============================================================================
# All browser-related rules consolidated from rules.conf and browser.conf

# Apply browser tag to all browsers for easy management
windowrule {
  name = browsers-tag-chromium
  match:class = ((google-)?[cC]hrom(e|ium)|[bB]rave-browser|[mM]icrosoft-edge|Vivaldi-stable|helium)

  tag = +browser +no-border
}

windowrule {
  name = browsers-tag-firefox
  match:class = ([fF]irefox|zen|Navigator|librewolf)

  tag = +browser +no-border
}

# ============================================================================
# WORKSPACE ASSIGNMENTS
# ============================================================================

# Workspace 1: Zen browser (primary)
windowrule {
  name = browser-zen-workspace
  match:class = ^(zen|Zen)$

  workspace = 1
}

# Workspace 5: Other browsers (secondary/alternate)
windowrule {
  name = browser-chromium-workspace
  match:class = ^(Google-chrome|google-chrome|Chromium|chromium)$

  workspace = 5
}

windowrule {
  name = browser-brave-workspace
  match:class = ^(brave-browser|Brave-browser)$

  workspace = 5
}

# ============================================================================
# OPACITY RULES (Conditional based on tiled/floating state)
# ============================================================================

# Zen browser: always solid opacity (no transparency)
windowrule {
  name = browser-zen-opaque
  match:class = ^(zen|Zen|Navigator)$

  opacity = 1 override 1 override
}

# Chrome/Chromium/Brave - Tiled: opaque
windowrule {
  name = browser-chromium-tiled-opaque
  match:class = ^((google-)?[cC]hrom(e|ium)|[bB]rave-browser)$
  match:float = false

  opacity = 1 override 1 override
}

# Chrome/Chromium/Brave - Floating: transparent (matches global default, kept for documentation)
# windowrule {
#   name = browser-chromium-floating-transparent
#   match:class = ^((google-)?[cC]hrom(e|ium)|[bB]rave-browser)$
#   match:float = true
#
#   opacity = 1 0.85
# }

# Firefox/Librewolf: solid opacity
windowrule {
  name = browser-firefox-opaque
  match:class = ^([fF]irefox|librewolf)$

  opacity = 1 override 1 override
}

# Video sites should never have opacity applied (override all above)
windowrule {
  name = browser-video-sites-opaque
  match:initial_title = ((?i)(?:[a-z0-9-]+\.)*youtube\.com_/|app\.zoom\.us_/wc/home)

  opacity = 1.0 1.0 override
}

# ============================================================================
# SPECIAL BEHAVIORS
# ============================================================================

# Keep focus on specific windows (e.g., payment receipts)
windowrule {
  name = browser-comprobante-stay-focused
  match:class = ^(Navigator|zen)$
  match:title = (?i)Comprobante

  stay_focused = on
}

# Zen save file dialog: float with specific size
windowrule {
  name = browser-zen-save-dialog
  match:class = ^(Navigator|zen|Zen)$
  match:title = .*Save as -.*

  float = on
  center = on
  size = 960 800
}

# ============================================================================
# CHROME WEBAPPS (AI ASSISTANTS)
# ============================================================================

# Grok webapp
windowrule {
  name = chrome-webapp-grok
  match:class = ^chrome-grok\.com__-Default$

  float = on
  size = 1259 1373
  tag = +chrome-webapp
}

# ChatGPT webapp
windowrule {
  name = chrome-webapp-chatgpt
  match:class = ^chrome-chatgpt\.com__-Default$

  float = on
  size = 1259 1373
  tag = +chrome-webapp
}

# Google Gemini webapp
windowrule {
  name = chrome-webapp-gemini
  match:class = ^chrome-gemini\.google\.com__-Default$

  float = on
  size = 1259 1373
  tag = +chrome-webapp
}
